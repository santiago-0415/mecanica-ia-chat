<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Taller Mecánico — Servicio Automotriz Flores 🚘</title>
  <link rel="stylesheet" href="../diseño/styles.css" />
  <link rel="icon" href="../imagenes/logo.jpeg" />
</head>
<body>

  <!-- ENCABEZADO / NAV -->
  <header class="topbar">
    <div class="topbar__inner">
      <div class="brand">
        <div class="brand__icon">
          <img src="../imagenes/logo.jpeg" alt="Logo Servicio Automotriz Flores" style="width:100%;height:100%;object-fit:cover;border-radius:10px" />
        </div>
        <div class="brand__text">
          <strong class="brand__title">Taller Mecanico</strong>
          <small class="brand__subtitle">Servicio Automotriz Flores</small>
        </div>
      </div>

      <nav class="nav">
        <a class="nav__link" href="index.html">Inicio</a>
        <a class="nav__link" href="clientes.php">Clientes</a>
        <a class="nav__link" href="citas.php">Citas</a>
        <a class="nav__link" href="orden_trabajo.php"> Notas </a>
      </nav>
    </div>
  </header>

  <main>

    <!-- HERO -->
    <section id="inicio" class="hero">
      <div class="hero__grid">
        <div class="hero__content">
          <span class="badge">Más de 6 años de experiencia</span>
          <h1 class="hero__title">Tu vehículo en las mejores manos</h1>
          <p class="hero__lead">
            Ofrecemos servicios de mecánica automotriz de calidad.
            Tu seguridad es nuestra prioridad.
          </p>

          <div class="hero__actions">
            <a class="btn btn--primary" href="tel:+527291487884">Llamar Ahora</a>
            <a class="btn btn--outline" href="#servicios">Ver Servicios</a>
          </div>
        </div>

        <figure class="hero__media">
          <!-- Reemplaza la ruta si tus imágenes están en otra carpeta -->
          <img class="hero__img" src="../imagenes/carro.png" alt="Taller mecánico profesional" />
        </figure>
      </div>
    </section>

    <!-- SERVICIOS -->
    <section id="servicios" class="section services">
      <div class="section__header section__header--center">
        <h2 class="section__title">Nuestros Servicios</h2>
        <p class="section__desc">Servicios completos de mecánica automotriz con garantía y atención personalizada</p>
      </div>

      <div class="cards cards--grid-3">
        <article class="card service">
          <div class="service__icon" aria-hidden="true">🚗</div>
          <h3 class="service__title">Mantenimiento Preventivo</h3>
          <p class="service__desc">Cambio de aceite, filtros, revisión general y mantenimiento programado</p>
        </article>

        <article class="card service">
          <div class="service__icon" aria-hidden="true"><span>⚙️</span><span>🔁</span><span>🕹️</span><span>🚘</span></div>
          <h3 class="service__title">Reparaciones de transmisiónes automaticas</h3>
          <p class="service__desc">Diagnóstico, servicio de ATF y filtro, ajuste/rehabilitación de cuerpo de válvulas y solenoides, y reemplazo de sellos para corregir deslizamientos y fallas de cambio.</p>
        </article>

        <article class="card service">
          <div class="service__icon" aria-hidden="true">🛡️</div>
          <h3 class="service__title">Diagnóstico Computarizado</h3>
          <p class="service__desc">Escaneo completo</p>
        </article>

        <article class="card service">
          <div class="service__icon" aria-hidden="true">⏱️</div>
          <h3 class="service__title">Servicio Express</h3>
          <p class="service__desc">Cambios rápidos de aceite y servicios menores en 50 minutos</p>
        </article>

        <article class="card service">
          <div class="service__icon" aria-hidden="true"><span>🔧</span><span>✨</span><span>🛢️</span><span>📊</span></div>
          <h3 class="service__title">Afinaciónes</h3>
          <p class="service__desc">Cambio de aceite y filtros, bujías nuevas y calibraciones/escaneo para mantener rendimiento y consumo óptimos.</p>
        </article>

        <article class="card service">
          <div class="service__icon" aria-hidden="true"><span>⚙️</span><span>🔧</span>🛠️<span>🚗</span></div>
          <h3 class="service__title">Ajustes de motores</h3>
          <p class="service__desc">Se diagnostica, desmonta, rectifica o calibra y se reemplazan piezas de desgaste para recuperar compresión, potencia y consumo normales.</p>
        </article>
      </div>
    </section>

    <!-- ¿POR QUÉ ELEGIRNOS? -->
    <section id="nosotros" class="section why">
      <div class="why__grid">
        <figure class="why__media">
          <img class="why__img" src="../imagenes/xqelegirnos.png" alt="Equipo de mecánicos profesionales" />
        </figure>

        <div class="why__content">
          <h2 class="section__title">¿Por qué elegirnos?</h2>

          <ul class="why__list">
            <li class="why__item">
              <span class="why__icon" aria-hidden="true">⭐</span>
              <div>
                <h3 class="why__title">Experiencia Comprobada</h3>
                <p class="why__desc">Más de 6 años brindando servicios de calidad</p>
              </div>
            </li>
            <li class="why__item">
              <span class="why__icon" aria-hidden="true">⭐</span>
              <div>
                <h3 class="why__title">Tecnología Moderna</h3>
                <p class="why__desc">Equipo de diagnóstico y herramientas especializadas</p>
              </div>
            </li>
            <li class="why__item">
              <span class="why__icon" aria-hidden="true">⭐</span>
              <div>
                <h3 class="why__title">Precios Justos</h3>
                <p class="why__desc">Presupuestos transparentes sin sorpresas ni costos ocultos</p>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- CONTACTO -->
    <section id="contacto" class="section contact">
      <div class="section__header section__header--center">
        <h2 class="section__title">Contáctanos</h2>
        <p class="section__desc">Estamos aquí para ayudarte con tu vehículo</p>
      </div>

      <div class="cards cards--grid-3">
        <article class="card contact__card contact__card--center">
          <div class="contact__icon" aria-hidden="true">📞</div>
          <h3 class="contact__title">Teléfono</h3>
          <p class="contact__strong">+ 527291487884</p>
          <p class="contact__muted">Lun - Vie: 9:00 AM - 6:00 PM</p>
          <p class="contact__muted">Sab: 9:00 AM - 6:00 PM</p>
        </article>

        <article class="card contact__card contact__card--center">
          <div class="contact__icon" aria-hidden="true">📍</div>
          <h3 class="contact__title">Ubicación</h3>
          <p class="contact__strong">Mecánica Flores</p>
          <p class="contact__muted">Calle Polotitlán, Sección 5-B, San Diego de los Padres Cuexcontitlán</p>

          <!-- Mapa dentro del recuadro (dirección completa) -->
          <div class="map-embed">
            <iframe
              title="Mapa: Servicio Automotriz Flores"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              src="https://www.google.com/maps?q=Mecanica+Flores+Calle+Polotitlan+Seccion+5B+San+Diego+de+los+Padres+Cuexcontitlan+Estado+de+Mexico&z=19&output=embed">
            </iframe>
            <a
              class="map-overlay"
              target="_blank"
              rel="noopener"
              aria-label="Abrir ubicación exacta en Google Maps"
              href="https://www.google.com/maps/dir/?api=1&destination=Mecanica+Flores+Calle+Polotitlan+Seccion+5B+San+Diego+de+los+Padres+Cuexcontitlan+Estado+de+Mexico"></a>
          </div>
        </article>

        <article class="card contact__card contact__card--center">
          <div class="contact__icon" aria-hidden="true">✉️</div>
          <h3 class="contact__title">Email</h3>
          <p class="contact__strong">Braandonflo91@gmail.com</p>
          <p class="contact__muted">Respuesta en 24 horas</p>
        </article>
      </div>
    </section>

  </main>

  <!-- PIE DE PÁGINA -->
  <footer class="footer">
    <div class="footer__grid">
      <div class="footer__brand">
        <div class="footer__logo">🔧</div>
        <strong class="footer__title">Mecanica Flores</strong>
        <p class="footer__text">Tu taller de confianza para el cuidado y mantenimiento de tu vehículo.</p>
      </div>

      <div class="footer__col">
        <h4 class="footer__col-title">Servicios</h4>
        <ul class="footer__list">
          <li>Mantenimiento</li>
          <li>Reparaciones</li>
          <li>Diagnóstico</li>
          <li>Afinaciónes</li>
        </ul>
      </div>

      <div class="footer__col">
        <h4 class="footer__col-title">Horarios</h4>
        <ul class="footer__list">
          <li>Lun - Vie: 9:00 AM - 6:00 PM</li>
          <li>Sábado: 9:00 AM - 6:00 PM</li>
          <li>Domingo: Cerrado</li>
        </ul>
      </div>

      <div class="footer__col">
        <h4 class="footer__col-title">Contacto</h4>
        <ul class="footer__list">
          <li>+52 (729) 148-7884</li>
          <li>Braandonflo91@gmail.com</li>
          <li>Calle Polotitlán</li>
        </ul>
      </div>
    </div>

    <div class="footer__copy">© 2025 Mecanica Flores. Todos los derechos reservados.</div>
</footer>

  <!-- ===== Botón flotante de IA (video redondo) ===== -->
  <button class="ai-fab" id="ai-fab" aria-label="Abrir asistente de IA">
    <video class="ai-fab__video" src="../imagenes/pistonesIA.mp4" autoplay muted loop playsinline></video>
    <span class="ai-fab__label" style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-family:system-ui,-apple-system,'Segoe UI',Roboto,sans-serif; font-weight:800; font-size:28px; color:#fff; text-shadow:0 2px 6px rgba(0,0,0,.45); pointer-events:none;">IA</span>
  </button>

  <!-- ===== Chatbot Gemini (cajón) ===== -->
  <aside class="chatbot" id="chatbot" aria-hidden="true" aria-label="Chat con IA Gemini">
  <header class="chatbot__header">
  <div class="chatbot__title">Asistente IA · Gemini</div>
  <button class="chatbot__reset" id="chatbot-reset" aria-label="Iniciar un nuevo chat">🔄</button>
  <button class="chatbot__close" id="chatbot-close" aria-label="Cerrar">×</button>
</header>
    <div class="chatbot__messages" id="chat-messages" role="log" aria-live="polite"></div>
    <form class="chatbot__form" id="chat-form">
      <input type="text" id="chat-input" placeholder="Escribe tu mensaje..." required />
      <button type="submit" class="btn btn--primary">Enviar</button>
    </form>
    <div class="chatbot__legal">No compartas datos sensibles. Respuestas generadas por IA.</div>
  </aside>
  <div class="chatbot__backdrop" id="chat-backdrop" hidden></div>

  <!-- ===== JS mínimo para abrir/cerrar y enviar mensajes (sin CSS) ===== -->
  <script>
    (function(){
  const fab = document.getElementById('ai-fab');
  const chat = document.getElementById('chatbot');
  const close = document.getElementById('chatbot-close');
  const backdrop = document.getElementById('chat-backdrop');
  const form = document.getElementById('chat-form');
  const input = document.getElementById('chat-input');
  const messages = document.getElementById('chat-messages');
  // AÑADE LA NUEVA VARIABLE DEL BOTÓN DE REINICIO
  const resetBtn = document.getElementById('chatbot-reset');
  // ...

      function openChat(){
        chat.classList.add('is-open');
        chat.setAttribute('aria-hidden','false');
        backdrop.hidden = false;
        setTimeout(()=> input.focus(), 50);
      }
      function closeChat(){
        chat.classList.remove('is-open');
        chat.setAttribute('aria-hidden','true');
        backdrop.hidden = true;
      }

      fab.addEventListener('click', openChat);
      close.addEventListener('click', closeChat);
      backdrop.addEventListener('click', closeChat);

      function appendMsg(who, text){
        const b = document.createElement('div');
        b.className = 'msg ' + (who === 'you' ? 'msg--you' : 'msg--bot');
        b.textContent = text;
        messages.appendChild(b);
        messages.scrollTop = messages.scrollHeight;
      }

      // Cambia este ENDPOINT por tu ruta en Python (Flask/FastAPI) que llame a Gemini
     const ENDPOINT = "http://127.0.0.1:5001/gemini-chat";
      const HEALTH = "http://127.0.0.1:5001/status"; // ¡CAMBIADO A /status!
      const RESET_ENDPOINT = "http://127.0.0.1:5001/gemini-reset"; // <--- ¡AÑADE ESTA LÍNEA!

      // Diagnóstico: comprobar backend al cargar
      fetch(HEALTH)
        .then(r => {
          if (!r.ok) { console.warn('Health no OK:', r.status); }
          return r.json().catch(() => ({}));
        })
        .then(j => console.log('Gemini backend:', j))
        .catch(err => console.error('No se pudo conectar al backend (health):', err));

      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        const text = input.value.trim();
        if(!text) return;
        appendMsg('you', text);
        input.value = '';

        try{
          const res = await fetch(ENDPOINT, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ prompt: text })
          });

          const contentType = res.headers.get('content-type') || '';
          const payload = contentType.includes('application/json') ? await res.json() : { reply: await res.text() };

          if(!res.ok){
            console.error('Error HTTP', res.status, payload);
            appendMsg('bot', 'Error ' + res.status + ': ' + (payload.reply || payload));
            return;
          }

          appendMsg('bot', payload.reply || 'Sin respuesta del servidor.');
        }catch(err){
          console.error('Fetch error:', err);
          appendMsg('bot', 'No se pudo conectar a ' + ENDPOINT + '. Revisa que el servidor Python esté corriendo (../ia/app.py) y CORS habilitado.');
        }
      });
      // Lógica para enviar mensajes...
  // ... (código existente del form.addEventListener('submit', async (e)=>{...})

  // NUEVA LÓGICA: REINICIAR CHAT
  resetBtn.addEventListener('click', async () => {
    messages.innerHTML = ''; // Limpia los mensajes visualmente
    appendMsg('bot', 'Reiniciando conversación...');

    try {
      const res = await fetch(RESET_ENDPOINT, { method: 'POST' });
      const payload = await res.json();

      if(res.ok && payload.status === 'ok'){
         // Muestra un mensaje de éxito después de la limpieza
         messages.innerHTML = ''; // Limpia otra vez por si acaso
         appendMsg('bot', '¡Listo! Comencemos un tema nuevo. ¿En qué vehículo necesitas ayuda?');
      } else {
         appendMsg('bot', '⚠️ Error al reiniciar el chat en el servidor. Intenta recargar la página.');
      }
    } catch (err) {
      console.error('Fetch error:', err);
      appendMsg('bot', 'No se pudo conectar al servidor para reiniciar. Revisa tu conexión.');
    }
  });
})();
    
  </script>

</body>
</html>